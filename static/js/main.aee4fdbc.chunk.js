(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){e.exports=a.p+"static/media/bg.6dc79205.jpg"},102:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),l=a.n(c),s=(a(74),a(42)),u=a(13),o=a.n(u),i=a(17),m=a(9),d=(a(76),a(15)),p=(a(77),a(144)),E=a(142),f=a(133),b=a(134),v=a(135),h=a(136),g=(a(78),Object(n.createContext)()),y=function(e){var t=e.reducer,a=e.initialState,c=e.children;return r.a.createElement(g.Provider,{value:Object(n.useReducer)(t,a)},c)},j=function(){return Object(n.useContext)(g)},O=a(27),x=a.n(O);var S=function(e){var t=e.user,a=Object(n.useState)(""),c=Object(m.a)(a,2),l=c[0],s=c[1],u=j(),o=Object(m.a)(u,2),i=o[0],d=i.myMessages,E=i.currentPeer,f=o[1];return Object(n.useEffect)((function(){d.map((function(e){console.log("yesss"),e.sender!==t.id&&e.receiver!==t.id||s(e)}))}),[d]),r.a.createElement("div",{onClick:function(){f({type:"SET_PEER",peer:t})},className:"sidebarChat d-flex align-items-center ".concat((null===E||void 0===E?void 0:E.id)===t.id&&"current bg-secondary text-white")},r.a.createElement("div",{className:" sidebarChat__avatar mr-3"},r.a.createElement(p.a,{src:"p",alt:t.name})),r.a.createElement("div",{className:"sidebarChat__info"},r.a.createElement("h5",{className:"m-0 p-0"},t.name),r.a.createElement("p",{className:"m-0 p-0"},l.sender===t.id?l.name:"You"," :"," ",l.message)),r.a.createElement("div",{className:"ml-auto"},r.a.createElement("small",null,x()(parseInt(l.timestamp)).format("lll")||"just now")))},N=a(60),w=a.n(N).a.create({baseURL:"https://mern-whatsapp-akash.herokuapp.com/"}),_=function(){var e=j(),t=Object(m.a)(e,2),a=t[0],c=a.users,l=a.user,s=a.myMessages,u=t[1],g=Object(n.useState)(""),y=Object(m.a)(g,2),O=y[0],x=y[1],N=Object(n.useState)([]),_=Object(m.a)(N,2),T=_[0],k=_[1],C=Object(n.useState)(""),M=Object(m.a)(C,2),I=M[0],B=M[1];return Object(n.useEffect)((function(){(function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/users").then((function(e){u({type:"SET_USERS",users:e.data.users.filter((function(e){return e.id!==(null===l||void 0===l?void 0:l.id)})).filter((function(e){return e.name.toLowerCase().includes(O.trim().toLowerCase())}))})}));case 2:return e.next=4,k(null===c||void 0===c?void 0:c.map((function(e){return s.map((function(t){t.sender===e.id&&B(t)})),Object(d.a)(Object(d.a)({},e),{},{lastMsg:I})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[l,O]),Object(n.useEffect)((function(){})),r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"p-2 sidebar__header d-flex"},r.a.createElement("div",{className:"mr-2"},r.a.createElement(p.a,{src:"ak",alt:null===l||void 0===l?void 0:l.name})),r.a.createElement("h2",{className:"text-info"},null===l||void 0===l?void 0:l.name),r.a.createElement("div",{className:"ml-auto"},r.a.createElement(E.a,null,r.a.createElement(f.a,null)),r.a.createElement(E.a,null,r.a.createElement(b.a,null)),r.a.createElement(E.a,null,r.a.createElement(v.a,null)))),r.a.createElement("div",{className:"sidebar__search my-3"},r.a.createElement(h.a,null),r.a.createElement("input",{type:"text",value:O,onChange:function(e){return x(e.target.value)},placeholder:"Search or start new chat",className:"ml-3 search-input outline-none"})),r.a.createElement("div",{className:"sidebar__chats bg-white"},console.log(T),null===T||void 0===T?void 0:T.map((function(e){return r.a.createElement(S,{key:e.id,user:e})}))))},T=(a(100),a(101),a(137)),k=a(138),C=a(139),M=function(){var e=j(),t=Object(m.a)(e,2),a=t[0],c=a.user,l=a.currentPeer,u=a.myMessages,d=t[1],f=Object(n.useState)(""),b=Object(m.a)(f,2),g=b[0],y=b[1],O=Object(n.useState)(),S=Object(m.a)(O,2),N=S[0],_=S[1];Object(n.useEffect)((function(){_(u.filter((function(e){return e.sender===(null===l||void 0===l?void 0:l.id)||e.receiver===(null===l||void 0===l?void 0:l.id)})))}),[l,u]);var M=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,w.post("/messages/new",{message:g,name:c.name,timestamp:x()(),receive:!1,sender:c.id,receiver:l.id});case 3:d({type:"SET_MESSAGES",array:[].concat(Object(s.a)(u),[{message:g,name:c.name,timestamp:x()(),receive:!1,sender:c.id,receiver:l.id}])}),y("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container chat  py-3"},r.a.createElement("div",{className:"chat__header d-flex align-items-center"},r.a.createElement(p.a,{src:"A",alt:null===l||void 0===l?void 0:l.name}),r.a.createElement("div",{className:"chat__headerInfo ml-3"},r.a.createElement("h4",{className:"m-0 p-0"},null===l||void 0===l?void 0:l.name),r.a.createElement("p",{className:"m-0 p-0"},"Last seen at...")),r.a.createElement("div",{className:"row ml-auto"},r.a.createElement("div",{className:"chat__headerRight ml-auto"},r.a.createElement(E.a,null,r.a.createElement(h.a,null)),r.a.createElement(E.a,null,r.a.createElement(T.a,null)),r.a.createElement(E.a,null,r.a.createElement(v.a,null))))),r.a.createElement("div",{className:"chat__body"},null===N||void 0===N?void 0:N.map((function(e){return r.a.createElement("p",{key:e.id,className:"message ".concat(e.sender===c.id&&"own-message")},r.a.createElement("h6",{className:"m-0 p-0"},e.message),r.a.createElement("small",{className:"chat__timestamp m-0 ml-auto"},r.a.createElement("i",null,x()(parseInt(e.timestamp)).format("LT")||"Just now")))}))),r.a.createElement("div",{className:"mt-auto"},r.a.createElement("form",{onSubmit:M,className:"chat__footer d-flex justify-content-center align-items-center"},r.a.createElement(k.a,null),r.a.createElement("input",{className:"outline-none form-control",type:"text",value:g,onChange:function(e){return y(e.target.value)},placeholder:"Type a message"}),r.a.createElement("button",{type:"submit",className:"send-button ".concat(!g&&"d-none")},r.a.createElement(C.a,null)))))},I=a(61),B=a.n(I),P=a(140),R=a(143),U=a(141);function L(){return Math.round(20*Math.random())-10}function A(){var e=50+L(),t=50+L();return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(-".concat(e,"%, -").concat(t,"%)")}}var G=Object(P.a)((function(e){return{paper:{position:"absolute",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function D(){var e=G(),t=j(),a=Object(m.a)(t,2),c=a[0].user,l=a[1],s=Object(n.useState)(A),u=Object(m.a)(s,1)[0],d=Object(n.useState)(!0),p=Object(m.a)(d,2),E=p[0],f=p[1],b=Object(n.useState)(""),v=Object(m.a)(b,2),h=v[0],g=v[1],y=Object(n.useState)(""),O=Object(m.a)(y,2),x=O[0],S=O[1],N=Object(n.useState)(""),_=Object(m.a)(N,2),T=_[0],k=_[1],C=Object(n.useState)(!0),M=Object(m.a)(C,2),I=M[0],B=M[1];Object(n.useEffect)((function(){c&&f(!1)}),[c]);var P=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),document.getElementById("err").innerText="",h.trim()){e.next=5;break}return document.getElementById("err").innerText="Enter email",e.abrupt("return");case 5:if(x.trim()){e.next=8;break}return document.getElementById("err").innerText="Enter password",e.abrupt("return");case 8:return e.next=10,w.post("/login",{email:h.trim(),password:x}).then((function(e){200===e.status&&l({type:"SET_USER",user:e.data.user})})).catch((function(e){document.getElementById("err").innerText="No account or wrong password, please try again"}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),document.getElementById("err").innerText="",T.trim()){e.next=5;break}return document.getElementById("err").innerText="Enter You name",e.abrupt("return");case 5:if(h.trim()){e.next=8;break}return document.getElementById("err").innerText="Enter email",e.abrupt("return");case 8:if(x.trim()){e.next=11;break}return document.getElementById("err").innerText="Enter password",e.abrupt("return");case 11:return e.next=13,w.post("/users/new",{name:T,email:h.trim(),password:x}).then((function(e){201===e.status&&l({type:"SET_USER",user:e.data.user})})).catch((function(e){document.getElementById("err").innerText="Sign up fail, please try again"}));case 13:f(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(R.a,{open:E,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement("div",{style:u,className:e.paper},I&&r.a.createElement("div",null,r.a.createElement("h2",{id:"simple-modal-title"},"Login with your Email and Password"),r.a.createElement("form",{onSubmit:P,className:e.root,noValidate:!0,autoComplete:"off"},r.a.createElement(U.a,{id:"outlined-error-helper-text",label:"Enter email",type:"email",error:!h.includes("@")&&!h.includes("."),value:h,onChange:function(e){return g(e.target.value)},variant:"outlined",className:"form-control mt-2"}),r.a.createElement(U.a,{error:x.length<6,id:"outlined-error-helper-text",label:"Enter password (at least 6 character)",type:"password",helperText:"Must be at least 6 character",value:x,onChange:function(e){return S(e.target.value)},variant:"outlined",className:"form-control my-5"}),r.a.createElement("p",{id:"err",className:"text-danger"}),r.a.createElement("button",{type:"submit",className:"btn btn-success"},"LOG IN")),r.a.createElement("p",null,"No account?"," ",r.a.createElement("button",{className:"btn text-danger",onClick:function(){return B(!1)}},"Sign Up")," ","here")),!I&&r.a.createElement("div",null,r.a.createElement("h2",{id:"simple-modal-title"},"Sign Up with your Email,Password and name"),r.a.createElement("form",{onSubmit:L,className:e.root,noValidate:!0,autoComplete:"off"},r.a.createElement(U.a,{error:T.length<3,id:"outlined-error-helper-text",label:"Enter your name",type:"text",helperText:"Must be at least 3 characters",value:T,onChange:function(e){return k(e.target.value)},variant:"outlined",className:"form-control my-5"}),r.a.createElement(U.a,{error:!h.includes("@")&&!h.includes("."),id:"outlined-error-helper-text",label:"Enter email",type:"email",value:h,onChange:function(e){return g(e.target.value)},variant:"outlined",className:"form-control mt-2"}),r.a.createElement(U.a,{id:"outlined-error-helper-text",helperText:"Must be at least 6 character",label:"Enter password",type:"password",error:x.length<6,value:x,onChange:function(e){return S(e.target.value)},variant:"outlined",className:"form-control my-5"}),r.a.createElement("p",{id:"err",className:"text-danger"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"SIGN UP")),r.a.createElement("p",null,"Already have a account?",r.a.createElement("button",{className:"btn text-danger",onClick:function(){return B(!0)}},"Login"),"here")))))}var J=function(){var e=j(),t=Object(m.a)(e,2),a=t[0],c=a.myMessages,l=a.user,u=t[1];return Object(n.useEffect)((function(){l&&function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/messages/".concat(l.id)).then((function(e){u({type:"SET_MESSAGES",array:e.data})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[l]),Object(n.useEffect)((function(){var e=new B.a("4bccf108508cfaa75620",{cluster:"mt1"}).subscribe("messages");return e.bind("inserted",(function(e){u({type:"SET_MESSAGES",array:[].concat(Object(s.a)(c),[e])})})),function(){e.unbind_all(),e.unsubscribe()}}),[c]),r.a.createElement("div",{className:"app"},r.a.createElement(D,null),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("div",{className:"row mt-4 app__body"},r.a.createElement("div",{className:"col-lg-4 col-md-5"},r.a.createElement(_,null)),r.a.createElement("div",{className:"col-lg-8 col-md-7"},r.a.createElement(M,{messages:c})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var V=function(e,t){switch(t.type){case"SET_USER":return Object(d.a)(Object(d.a)({},e),{},{user:t.user});case"SET_MESSAGES":return Object(d.a)(Object(d.a)({},e),{},{myMessages:t.array});case"SET_USERS":return Object(d.a)(Object(d.a)({},e),{},{users:t.users});case"SET_PEER":return Object(d.a)(Object(d.a)({},e),{},{currentPeer:t.peer});default:return e}};l.a.render(r.a.createElement(y,{initialState:{user:null,myMessages:[],allUser:[],currentPeer:null,currentMessage:[]},reducer:V},r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},69:function(e,t,a){e.exports=a(102)},74:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.aee4fdbc.chunk.js.map